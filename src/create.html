<html>
  <body>
    <center id='upload'>  
    <h1>Create a Chart</h1>
    <br><br>
      <input type='text' id="title" placeholder="Title">
      <input type='text' id="description" placeholder="Description">
      <br>
      <br>
      <div id='opinions'>
        <input type='text' placeholder="Opinion here..."> 
      </div>
      <br id='break'>
      <button id='add_more' type="button">Add Another Opinion</button>
      <button id='submit'>Submit</button>
    </center>

  <script>
  var current = 0;
  const opinions = document.getElementById('opinions')
  document.getElementById('add_more').onclick = e => {
    current++
    const next_input = document.createElement('input')
    next_input.type = 'text'
    next_input.placeholder = 'Opinion here...'
    opinions.appendChild(document.createElement('br'))
    opinions.appendChild(next_input)
  }

  document.getElementById('submit').onclick = e => {
    const obj = {
      title: document.getElementById('title').value,
      description: document.getElementById('description').value,
      opinions: Array.from(document.getElementById("opinions").childNodes).filter(node => node.nodeName === "INPUT").map(item => item.value)
    }

    const xml = new XMLHttpRequest()
    xml.open("POST", "/create", false)
    xml.setRequestHeader("Content-Type", "application/json")
    try {
      xml.send(JSON.stringify(obj))

      document.getElementsByTagName("html")[0].innerHTML = xml.response
    } catch (e) {
      alert("There was an error uploading your request")
    }
  
  }
  </script>
  </body>
</html>
